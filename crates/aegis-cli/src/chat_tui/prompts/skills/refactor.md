Refactor the specified code:

1. Analyze current structure and identify issues
2. Propose refactoring approach (explain before doing)
3. Make changes incrementally
4. Ensure tests still pass after changes
5. Keep functionality identical

Focus on: readability, maintainability, reducing duplication, better abstractions.

Target: $ARGUMENTS
